---
import Header from "@components/Header";
import Hero from "@components/Hero";
import Services from "@components/Services";
import About from "@components/About";
import Process from "@components/Process";
import Gallery from "@components/Gallery";
import Formations from "@components/Formations";
import Team from "@components/Team";
import Testimonials from "@components/Testimonials";
import FAQ from "@components/FAQ";
import Newsletter from "@components/Newsletter";
import Contact from "@components/Contact";
import Footer from "@components/Footer";
import FloatingCTA from "@components/FloatingCTA";
import ScrollToTop from "@components/ScrollToTop";
import AnimatedSection from "@components/AnimatedSection";
import BaseLayout from "@layouts/BaseLayout.astro";

// Importez getCollection pour récupérer les données des collections
import { getCollection } from 'astro:content';

// Récupérez les données des collections SQLite
const services = (await getCollection('services')).map(entry => entry.data);
const teamMembers = (await getCollection('team_members')).map(entry => entry.data);
const testimonials = (await getCollection('testimonials')).map(entry => entry.data);
const formations = (await getCollection('formations')).map(entry => entry.data);

// Pour FAQ, récupérez les données groupées
const faqDataEntry = await getCollection('faqs');
const faqData = faqDataEntry[0]?.data.faqData || [];
---

<BaseLayout title="Home" description="Welcome to our homepage">
  
<div class="min-h-screen">
  <Header />

  <Hero client:load />

  <AnimatedSection animation="fade-in" client:visible>
    <Services services={services} client:load />
  </AnimatedSection>

  <AnimatedSection animation="slide-up" delay={100} client:visible>
    <About />
  </AnimatedSection>

  <AnimatedSection animation="fade-in" delay={200} client:visible>
    <Process />
  </AnimatedSection>

  <AnimatedSection animation="slide-left" delay={100} client:visible>
    <Gallery client:load />
  </AnimatedSection>

  <AnimatedSection animation="scale-in" client:visible>
    <Formations formations={formations} client:load />
  </AnimatedSection>

  <AnimatedSection animation="slide-right" delay={150} client:visible>
    <Team teamMembers={teamMembers} client:load />
  </AnimatedSection>

  <AnimatedSection animation="fade-in" delay={100} client:visible>
    <Testimonials testimonials={testimonials} client:load />
  </AnimatedSection>

  <AnimatedSection animation="slide-up" delay={200} client:visible>
    <FAQ faqData={faqData} client:load />
  </AnimatedSection>

  <AnimatedSection animation="scale-in" delay={100} client:visible>
    <Newsletter />
  </AnimatedSection>

  <AnimatedSection animation="fade-in" client:visible>
    <Contact />
  </AnimatedSection>

  <FloatingCTA client:load />
  <ScrollToTop client:load />
</div>

</BaseLayout>